Import('env')

env.Append(
    CPPPATH = ['compat'],
)

if 'DEBUG' in env['CPPDEFINES']:
    # We don't want libtar DEBUG
    del env['CPPDEFINES']['DEBUG']
else:
    env['CPPDEFINES']['LIBTAR_NO_OUTPUT'] = 1

libtar = env.StaticLibrary(
    target = 'tar',
    source = [
        'block.c',
        'decode.c',
        'extract.c',
        'handle.c',
        'output.c',
        'util.c',
        'compat/strlcpy.c',
        'compat/strmode.c',
    ]
)

Return('libtar')
